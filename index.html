<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üèÑ‚Äç‚ôÄÔ∏è Surf Nicaragua</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Comic Sans MS', 'Arial', sans-serif;
            overflow: hidden;
            touch-action: none;
            background: linear-gradient(180deg, #87CEEB 0%, #FFD700 100%);
        }

        #gameCanvas {
            display: block;
            width: 100vw;
            height: 100vh;
            cursor: pointer;
        }

        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            z-index: 10;
        }

        #titleScreen {
            background-image: url('assets/start_bg.png');
            background-size: auto 100%;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #87CEEB;
        }

        #gameOverSurfer {
            background-image: url('assets/unavailable.jpg');
            background-size: auto 100%;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #87CEEB;
        }

        #gameOverRock {
            background-image: url('assets/good_end.jpg');
            background-size: auto 100%;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #87CEEB;
        }

        #gameOverRockIncomplete {
            background-image: url('assets/bad_end.jpg');
            background-size: auto 100%;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #87CEEB;
        }

        .hidden {
            display: none !important;
        }

        h1 {
            font-size: 3em;
            color: #FF6B35;
            text-shadow: 3px 3px 0 #FFF, 6px 6px 0 rgba(0,0,0,0.2);
            margin-top: 30px;
            margin-bottom: 20px;
            text-align: center;
            padding: 0 20px;
        }

        .subtitle {
            font-size: 1.2em;
            color: #2C3E50;
            margin-bottom: 30px;
            text-align: center;
            padding: 0 20px;
        }

        button {
            font-size: 1.5em;
            padding: 15px 40px;
            background: #FF6B35;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 0 #D64A1F;
            transition: all 0.1s;
            font-weight: bold;
            margin-top: auto;
            margin-bottom: 40px;
        }

        button:active {
            transform: translateY(3px);
            box-shadow: 0 2px 0 #D64A1F;
        }

        .score-display {
            font-size: 2em;
            color: #2C3E50;
            margin: 20px 0;
            text-shadow: 2px 2px 0 #FFF;
        }

        .speech-bubble {
            position: relative;
            background: white;
            border: 4px solid #2C3E50;
            border-radius: 20px;
            padding: 18px;
            max-width: 350px;
            margin: 20px;
            font-size: 0.7em;
            line-height: 1.5;
            color: #2C3E50;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .speech-bubble::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50px;
            width: 0;
            height: 0;
            border: 20px solid transparent;
            border-top-color: white;
            border-bottom: 0;
            margin-left: -20px;
        }

        .speech-bubble::before {
            content: '';
            position: absolute;
            bottom: -28px;
            left: 50px;
            width: 0;
            height: 0;
            border: 24px solid transparent;
            border-top-color: #2C3E50;
            border-bottom: 0;
            margin-left: -24px;
        }

        .speech-bubble strong {
            color: #FF6B35;
        }

        .speech-bubble-up {
            position: relative;
            background: white;
            border: 4px solid #2C3E50;
            border-radius: 20px;
            padding: 18px;
            max-width: 350px;
            margin: 20px;
            font-size: 0.7em;
            line-height: 1.5;
            color: #2C3E50;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .speech-bubble-up::after {
            content: '';
            position: absolute;
            top: -20px;
            left: 50px;
            width: 0;
            height: 0;
            border: 20px solid transparent;
            border-bottom-color: white;
            border-top: 0;
            margin-left: -20px;
        }

        .speech-bubble-up::before {
            content: '';
            position: absolute;
            top: -28px;
            left: 50px;
            width: 0;
            height: 0;
            border: 24px solid transparent;
            border-bottom-color: #2C3E50;
            border-top: 0;
            margin-left: -24px;
        }

        .speech-bubble-up strong {
            color: #FF6B35;
        }

        .text-box {
            position: relative;
            background: white;
            border: 4px solid #2C3E50;
            border-radius: 20px;
            padding: 18px;
            max-width: 350px;
            margin: 20px;
            margin-top: auto;
            font-size: 0.7em;
            line-height: 1.5;
            color: #2C3E50;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
                margin-top: 20px;
            }
            .subtitle {
                font-size: 1em;
            }
            button {
                font-size: 1.2em;
                padding: 12px 30px;
            }
            .speech-bubble {
                padding: 20px;
                max-width: 85%;
            }
            .text-box {
                padding: 20px;
                max-width: 85%;
            }
            .speech-bubble-up {
                padding: 20px;
                max-width: 85%;
            }
        }
    </style>
</head>
<body>
    <div id="titleScreen" class="screen">
        <h1>üèÑ‚Äç‚ôÄÔ∏è SURF NICA üèÑüèº‚Äç‚ôÄÔ∏è</h1>
        <div class="speech-bubble">
            Hola! Willkommen in Nica! üå¥<br><br>
            Ich bin Kirsten und brauche ganz dringend deine Hilfe.
            Heute sind wirklich super Waves und meine Surf Skills reichen einfach nicht aus um sie alle zu catchen üòï <br><br>
            
            Drau√üen auf dem Meer findest du einige meiner Lieblingssachen. Sammle sie ein um meinen Tag perfekt zu machen!
            Aber pass auf! Es sind auch viele Felsen und emotionally unavailable Surfer Boys auf dem Wasser! Die d√ºrfen wir auf keinen Fall erwischen.<br><br>
            
            <strong>Tippe links/rechts</strong> oder nutze die <strong>Pfeiltasten</strong> um zu surfen!
        </div>
        <button id="startButton">START SURFING</button>
    </div>

    <canvas id="gameCanvas" class="hidden"></canvas>

    <div id="gameOverSurfer" class="screen hidden">
        <h1>üíî OH NEIN! üíî</h1>
        <div class="score-display">Score: <span id="finalScoreSurfer">0</span></div>
        <div class="text-box">
            Oh nein! Ein emotionally unavailable Surfer Boy hat dich um den Finger gewickelt!
            Er wird dir sicher das Herz brechen. Dein Tag ist ruiniert üò≠
        </div>
        <button id="restartButtonSurfer">TRY AGAIN</button>
    </div>

    <div id="gameOverRock" class="screen hidden">
        <h1>ü§ôüèº WOO HOO! ü§ôüèº</h1>
        <div class="score-display">Score: <span id="finalScoreRock">0</span></div>
        <div class="speech-bubble-up" style="margin-top: auto;">
            Du hast 3 Felsen erwischt und dein Board ist zu Bruch gegangen... Zum Gl√ºck war es nur geliehen. <br><br>
            OMG, wie ich sehe konntest du <strong><span id="matchaCount">0</span> Matchas</strong>, <strong><span id="volleyballCount">0</span> Volleyb√§lle</strong> und <strong><span id="sunsetCount">0</span> Sonnenunterg√§nge</strong> sammeln! <br><br>
            Mein Tag ist gerettet, danke f√ºr deine Hilfe! ü§ôüèº Jetzt kann ich entspannt in den Tag starten.
        </div>
        <button id="restartButtonRock" style="margin-top: 0; margin-bottom: 40px;">TRY AGAIN</button>
    </div>

    <div id="gameOverRockIncomplete" class="screen hidden">
        <h1>üò≠ OH NEIN! üò≠</h1>
        <div class="score-display">Score: <span id="finalScoreRockIncomplete">0</span></div>
        <div class="speech-bubble-up" style="margin-top: auto;">
            Oh nein! Du hast 3 Felsen erwischt und dein Board ist zu Bruch gegangen...<br><br>
            Leider hast du nicht alle meiner Lieblingssachen aufgesammelt. Ein Tag ohne Matcha, Volleyball und Sunset ist einfach kein guter Tag...<br><br>
            Mission Failed.
        </div>
        <button id="restartButtonRockIncomplete" style="margin-top: 0; margin-bottom: 40px;">TRY AGAIN</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const titleScreen = document.getElementById('titleScreen');
        const gameOverSurfer = document.getElementById('gameOverSurfer');
        const gameOverRock = document.getElementById('gameOverRock');
        const gameOverRockIncomplete = document.getElementById('gameOverRockIncomplete');
        const startButton = document.getElementById('startButton');
        const restartButtonSurfer = document.getElementById('restartButtonSurfer');
        const restartButtonRock = document.getElementById('restartButtonRock');
        const restartButtonRockIncomplete = document.getElementById('restartButtonRockIncomplete');
        const finalScoreSurfer = document.getElementById('finalScoreSurfer');
        const finalScoreRock = document.getElementById('finalScoreRock');
        const finalScoreRockIncomplete = document.getElementById('finalScoreRockIncomplete');
        const matchaCountDisplay = document.getElementById('matchaCount');
        const volleyballCountDisplay = document.getElementById('volleyballCount');
        const sunsetCountDisplay = document.getElementById('sunsetCount');

        let gameState = 'title';
        let score = 0;
        let lives = 3;
        let speed = 2;
        let gameTime = 0;
        let matchaCollected = 0;
        let volleyballCollected = 0;
        let sunsetCollected = 0;

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        const surfer = {
            x: canvas.width / 2,
            y: canvas.height - 200,
            width: 100,
            height: 100,
            targetX: canvas.width / 2,
            speed: 6,
            movingLeft: false,
            movingRight: false
        };

        const items = [];
        const particles = [];
        const floatingTexts = [];

        const backgroundImg = new Image();
        backgroundImg.src = 'assets/background.png';
        let backgroundLoaded = false;
        backgroundImg.onload = () => {
            backgroundLoaded = true;
        };

        const surferImg = new Image();
        surferImg.src = 'assets/surfer.png';
        let surferLoaded = false;
        surferImg.onload = () => {
            surferLoaded = true;
        };

        const matchaImg = new Image();
        matchaImg.src = 'assets/matcha.png';
        const volleyballImg = new Image();
        volleyballImg.src = 'assets/volleyball.png';
        const sunsetImg = new Image();
        sunsetImg.src = 'assets/sunset.webp';
        const rockImg = new Image();
        rockImg.src = 'assets/rock.png';
        const surferObstacleImg = new Image();
        surferObstacleImg.src = 'assets/surfer_obstacle.png';

        function spawnItem() {
            const rand = Math.random();
            let type, subtype, points, size;
            
            if (rand < 0.6) {
                // 65% collectibles, evenly distributed
                type = 'collectible';
                const collectibleRand = Math.random();
                if (collectibleRand < 0.333) {
                    subtype = 'matcha';
                    points = 10;
                    size = 70;
                } else if (collectibleRand < 0.666) {
                    subtype = 'volleyball';
                    points = 15;
                    size = 75;
                } else {
                    subtype = 'sunset';
                    points = 20;
                    size = 80;
                }
            } else if (rand < 0.9) {
                // 25% rocks
                type = 'obstacle';
                subtype = 'rock';
                points = 0;
                size = 75;
            } else {
                // 10% surfers
                type = 'obstacle';
                subtype = 'surfer';
                points = 0;
                size = 75;
            }
            
            items.push({
                x: Math.random() * (canvas.width - 100) + 50,
                y: -50,
                width: size,
                height: size,
                type: type,
                subtype: subtype,
                points: points
            });
        }

        function createParticles(x, y, emoji) {
            for (let i = 0; i < 8; i++) {
                particles.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 4,
                    vy: (Math.random() - 0.5) * 4,
                    emoji: emoji,
                    life: 30
                });
            }
        }

        function createFloatingText(x, y, text, color) {
            floatingTexts.push({
                x: x,
                y: y,
                text: text,
                color: color,
                life: 60,
                vy: -2
            });
        }

        function checkCollision(item) {
            const surferLeft = surfer.x - surfer.width / 2;
            const surferRight = surfer.x + surfer.width / 2;
            const surferTop = surfer.y - surfer.height / 2;
            const surferBottom = surfer.y + surfer.height / 2;
            
            const itemLeft = item.x - item.width / 2;
            const itemRight = item.x + item.width / 2;
            const itemTop = item.y - item.height / 2;
            const itemBottom = item.y + item.height / 2;
            
            return surferLeft < itemRight &&
                   surferRight > itemLeft &&
                   surferTop < itemBottom &&
                   surferBottom > itemTop;
        }

        function updateGame() {
            if (gameState !== 'playing') return;

            gameTime++;
            
            if (surfer.movingLeft) {
                surfer.x = Math.max(50, surfer.x - surfer.speed);
            }
            if (surfer.movingRight) {
                surfer.x = Math.min(canvas.width - 50, surfer.x + surfer.speed);
            }
            
            if (gameTime % Math.max(50 - Math.floor(gameTime / 600), 30) === 0) {
                spawnItem();
            }

            speed = 3 + gameTime / 400;

            for (let i = items.length - 1; i >= 0; i--) {
                items[i].y += speed;

                if (checkCollision(items[i])) {
                    if (items[i].type === 'collectible') {
                        score += items[i].points;
                        if (items[i].subtype === 'matcha') matchaCollected++;
                        else if (items[i].subtype === 'volleyball') volleyballCollected++;
                        else if (items[i].subtype === 'sunset') sunsetCollected++;
                        createParticles(items[i].x, items[i].y, items[i].subtype === 'sunset' ? 'üåÖ' : '‚ú®');
                        createFloatingText(items[i].x, items[i].y, '+' + items[i].points, '#FFD700');
                    } else {
                        if (items[i].subtype === 'surfer') {
                            gameOver('surfer');
                        } else {
                            lives--;
                            createParticles(items[i].x, items[i].y, 'üí•');
                            createFloatingText(items[i].x, items[i].y, '-1 ‚ù§Ô∏è', '#FF0000');
                            if (lives <= 0) {
                                gameOver('rock');
                            }
                        }
                    }
                    items.splice(i, 1);
                } else if (items[i].y > canvas.height + 50) {
                    items.splice(i, 1);
                }
            }

            for (let i = particles.length - 1; i >= 0; i--) {
                particles[i].x += particles[i].vx;
                particles[i].y += particles[i].vy;
                particles[i].life--;
                if (particles[i].life <= 0) {
                    particles.splice(i, 1);
                }
            }

            for (let i = floatingTexts.length - 1; i >= 0; i--) {
                floatingTexts[i].y += floatingTexts[i].vy;
                floatingTexts[i].life--;
                if (floatingTexts[i].life <= 0) {
                    floatingTexts.splice(i, 1);
                }
            }
        }

        function drawGame() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            ctx.save();
            if (backgroundLoaded) {
                ctx.drawImage(backgroundImg, 0, 0, canvas.width, canvas.height);
            } else {
                const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
                gradient.addColorStop(0, '#87CEEB');
                gradient.addColorStop(0.6, '#4FC3F7');
                gradient.addColorStop(1, '#0288D1');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }
            ctx.restore();

            ctx.save();
            ctx.globalAlpha = 1;
            ctx.globalCompositeOperation = 'source-over';
            items.forEach(item => {
                if (item.subtype === 'matcha') {
                    ctx.drawImage(matchaImg, item.x - item.width/2, item.y - item.height/2, item.width, item.height);
                } else if (item.subtype === 'volleyball') {
                    ctx.drawImage(volleyballImg, item.x - item.width/2, item.y - item.height/2, item.width, item.height);
                } else if (item.subtype === 'sunset') {
                    ctx.drawImage(sunsetImg, item.x - item.width/2, item.y - item.height/2, item.width, item.height);
                } else if (item.subtype === 'rock') {
                    ctx.drawImage(rockImg, item.x - item.width/2, item.y - item.height/2, item.width, item.height);
                } else if (item.subtype === 'surfer') {
                    ctx.drawImage(surferObstacleImg, item.x - item.width/2, item.y - item.height/2, item.width, item.height);
                }
            });
            ctx.restore();

            ctx.save();
            ctx.globalCompositeOperation = 'source-over';
            particles.forEach(particle => {
                ctx.globalAlpha = particle.life / 30;
                ctx.font = '20px Arial';
                ctx.fillText(particle.emoji, particle.x, particle.y);
            });
            ctx.restore();

            ctx.save();
            floatingTexts.forEach(text => {
                ctx.globalAlpha = text.life / 60;
                ctx.font = 'bold 28px Arial';
                ctx.fillStyle = text.color;
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 3;
                ctx.strokeText(text.text, text.x, text.y);
                ctx.fillText(text.text, text.x, text.y);
            });
            ctx.restore();

            ctx.save();
            ctx.globalAlpha = 1;
            ctx.globalCompositeOperation = 'source-over';
            if (surferLoaded) {
                ctx.drawImage(surferImg, surfer.x - surfer.width / 2, surfer.y - surfer.height / 2, surfer.width, surfer.height);
            } else {
                ctx.font = '45px Arial';
                ctx.fillText('üèÑ‚Äç‚ôÄÔ∏è', surfer.x - 20, surfer.y + 30);
            }
            ctx.restore();

            ctx.save();
            ctx.fillStyle = '#FFF';
            ctx.font = 'bold 24px Arial';
            ctx.shadowColor = 'rgba(0,0,0,0.5)';
            ctx.shadowBlur = 5;
            ctx.fillText(`Score: ${score}`, 20, 40);
            
            const heartText = '‚ù§Ô∏è'.repeat(lives);
            ctx.fillText(heartText, 20, 75);
            ctx.restore();
        }

        function gameLoop() {
            updateGame();
            drawGame();
            requestAnimationFrame(gameLoop);
        }

        function startGame() {
            gameState = 'playing';
            score = 0;
            lives = 3;
            speed = 2;
            gameTime = 0;
            matchaCollected = 0;
            volleyballCollected = 0;
            sunsetCollected = 0;
            items.length = 0;
            particles.length = 0;
            floatingTexts.length = 0;
            surfer.x = canvas.width / 2;
            surfer.movingLeft = false;
            surfer.movingRight = false;
            
            titleScreen.classList.add('hidden');
            gameOverSurfer.classList.add('hidden');
            gameOverRock.classList.add('hidden');
            gameOverRockIncomplete.classList.add('hidden');
            canvas.classList.remove('hidden');
        }

        function gameOver(lossType) {
            gameState = 'gameOver';
            canvas.classList.add('hidden');
            
            if (lossType === 'surfer') {
                finalScoreSurfer.textContent = score;
                gameOverSurfer.classList.remove('hidden');
            } else if (lossType === 'rock') {
                const collectedAllTypes = matchaCollected > 0 && volleyballCollected > 0 && sunsetCollected > 0;
                
                if (collectedAllTypes) {
                    finalScoreRock.textContent = score;
                    matchaCountDisplay.textContent = matchaCollected;
                    volleyballCountDisplay.textContent = volleyballCollected;
                    sunsetCountDisplay.textContent = sunsetCollected;
                    gameOverRock.classList.remove('hidden');
                } else {
                    finalScoreRockIncomplete.textContent = score;
                    gameOverRockIncomplete.classList.remove('hidden');
                }
            }
        }

        function returnToTitle() {
            gameState = 'title';
            gameOverSurfer.classList.add('hidden');
            gameOverRock.classList.add('hidden');
            gameOverRockIncomplete.classList.add('hidden');
            canvas.classList.add('hidden');
            titleScreen.classList.remove('hidden');
        }

        function handleTouchStart(e) {
            e.preventDefault();
            if (gameState !== 'playing') return;
            
            const touches = e.touches || [e];
            const rect = canvas.getBoundingClientRect();
            
            for (let touch of touches) {
                const touchX = (touch.clientX || touch.pageX) - rect.left;
                
                if (touchX < canvas.width / 2) {
                    surfer.movingLeft = true;
                    surfer.movingRight = false;
                } else {
                    surfer.movingRight = true;
                    surfer.movingLeft = false;
                }
            }
        }

        function handleTouchEnd(e) {
            e.preventDefault();
            surfer.movingLeft = false;
            surfer.movingRight = false;
        }

        canvas.addEventListener('mousedown', handleTouchStart);
        canvas.addEventListener('mouseup', handleTouchEnd);
        canvas.addEventListener('mouseleave', handleTouchEnd);
        canvas.addEventListener('touchstart', handleTouchStart);
        canvas.addEventListener('touchend', handleTouchEnd);
        canvas.addEventListener('touchcancel', handleTouchEnd);

        document.addEventListener('keydown', (e) => {
            if (gameState !== 'playing') return;
            
            if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
                e.preventDefault();
                surfer.movingLeft = true;
                surfer.movingRight = false;
            } else if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
                e.preventDefault();
                surfer.movingRight = true;
                surfer.movingLeft = false;
            }
        });

        document.addEventListener('keyup', (e) => {
            if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
                surfer.movingLeft = false;
            } else if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
                surfer.movingRight = false;
            }
        });

        startButton.addEventListener('click', startGame);
        restartButtonSurfer.addEventListener('click', returnToTitle);
        restartButtonRock.addEventListener('click', returnToTitle);
        restartButtonRockIncomplete.addEventListener('click', returnToTitle);

        gameLoop();
    </script>
</body>
</html>
